{
  "outcome_positions_v2": "CREATE VIEW default.outcome_positions_v2\\n(\\n    `wallet` String,\\n    `condition_id_norm` String,\\n    `outcome_idx` UInt8,\\n    `net_shares` Float64\\n)\\nAS SELECT\\n    wallet,\\n    condition_id_norm,\\n    outcome_idx,\\n    sum(net_shares) AS net_shares\\nFROM\\n(\\n    SELECT\\n        lower(cf.proxy_wallet) AS wallet,\\n        lower(replaceAll(cf.condition_id, \\'0x\\', \\'\\')) AS condition_id_norm,\\n        ctm.outcome_index AS outcome_idx,\\n        if(cf.side = \\'BUY\\', 1., -1.) * (cf.size / 1000000.) AS net_shares\\n    FROM default.clob_fills AS cf\\n    INNER JOIN default.ctf_token_map AS ctm ON cf.asset_id = ctm.token_id\\n    WHERE (cf.condition_id IS NOT NULL) AND (cf.condition_id != \\'\\') AND (cf.condition_id != \\'0x0000000000000000000000000000000000000000000000000000000000000000\\')\\n)\\nGROUP BY\\n    wallet,\\n    condition_id_norm,\\n    outcome_idx\\nHAVING abs(net_shares) > 0.0001\n",
  "realized_pnl_by_market_final": "CREATE VIEW default.realized_pnl_by_market_final\\n(\\n    `wallet` String,\\n    `condition_id_norm` String,\\n    `resolved_at` Nullable(DateTime64(3)),\\n    `realized_pnl_usd` Float64\\n)\\nAS WITH cashflows_agg AS\\n    (\\n        SELECT\\n            wallet,\\n            condition_id_norm,\\n            outcome_idx,\\n            sum(cashflow_usdc) AS total_cashflow\\n        FROM default.trade_cashflows_v3\\n        GROUP BY\\n            wallet,\\n            condition_id_norm,\\n            outcome_idx\\n    )\\nSELECT\\n    p.wallet AS wallet,\\n    p.condition_id_norm AS condition_id_norm,\\n    wi.resolved_at AS resolved_at,\\n    round(coalesce(cf.total_cashflow, 0.) + sumIf(p.net_shares, p.outcome_idx = wi.win_idx), 4) AS realized_pnl_usd\\nFROM default.outcome_positions_v2 AS p\\nLEFT JOIN default.winning_index AS wi ON wi.condition_id_norm = p.condition_id_norm\\nLEFT JOIN\\ncashflows_agg AS cf ON (cf.wallet = p.wallet) AND (cf.condition_id_norm = p.condition_id_norm) AND (cf.outcome_idx = p.outcome_idx)\\nWHERE wi.win_idx IS NOT NULL\\nGROUP BY\\n    wallet,\\n    condition_id_norm,\\n    resolved_at,\\n    cf.total_cashflow\n"
}