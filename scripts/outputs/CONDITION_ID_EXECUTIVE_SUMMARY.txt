================================================================================
CONDITION ID BACKFILL - EXECUTIVE SUMMARY
================================================================================

QUESTION:
Can we populate 77.4M missing condition_ids using metadata WITHOUT blockchain?

ANSWER: NO

Recovery Rate via Metadata: 0.13% (only ~100K of 77.4M)
Reason: erc1155_transfers table only has 291K rows (incomplete backfill)

================================================================================
KEY FINDINGS
================================================================================

1. Missing Data: 77,435,673 trades (48.53%) lack condition_id

2. Available Tables:
   - market_resolutions_final: 224K markets with condition_ids
   - erc1155_transfers: Only 291K rows (NOT comprehensive)
   - ctf_token_map: 41K mappings (many incomplete)

3. Critical Gap:
   - trades.market_id = all zeros for 99.02% of missing trades
   - erc1155_transfers only matches 0.13% of transactions
   - No direct join path exists

================================================================================
OPTIONS & TIME ESTIMATES
================================================================================

OPTION 1: Complete ERC1155 Blockchain Backfill (MOST COMPLETE)
  Time: 18-27 days
  Recovery: 95-98%
  Method: Resume scripts/phase2-full-erc1155-backfill-*.ts
  Pros: Comprehensive, permanent solution
  Cons: Very slow

OPTION 2: Polymarket API Recovery (FASTEST)
  Time: 2-4 hours
  Recovery: 10-20%
  Method: Query API for market metadata by slug/id
  Pros: Fast, API-based
  Cons: Low coverage, requires valid market identifiers

OPTION 3: Hybrid (BALANCED)
  Time: 4-9 hours
  Recovery: 60-70%
  Method: API for recent + targeted blockchain for high-volume
  Pros: Good balance of speed and coverage
  Cons: Complex, requires multiple data sources

QUICK WIN: Recover 759K trades with valid market_id
  Time: < 1 hour
  Recovery: 0.98% of missing (immediate validation)
  Method: JOIN trades_raw → condition_market_map via market_id

================================================================================
RECOMMENDED ACTION
================================================================================

IF deadline is < 9 hours:
  → Use OPTION 3 (Hybrid)
  → Focus on last 6 months + high-volume markets
  → Accept 60-70% recovery

IF data completeness required:
  → Use OPTION 1 (Full ERC1155 Backfill)
  → Allocate 18-27 days
  → Achieve 95-98% recovery

IMMEDIATE NEXT STEP (validation):
  → Run Quick Win query (see report)
  → Recover 759K trades in < 1 hour
  → Verify join approach works

================================================================================
WHY BLOCKCHAIN WAS NEEDED ORIGINALLY
================================================================================

- CLOB API fills don't include condition_id
- condition_id only exists in ERC1155 token_id encoding
- Link requires matching tx_hash between USDC + ERC1155 transfers
- Current erc1155_transfers is only a pilot (291K of ~millions)

================================================================================
FILES CREATED
================================================================================

Full Analysis:
  /Users/scotty/Projects/Cascadian-app/CONDITION_ID_BACKFILL_FINAL_REPORT.md

Investigation Scripts:
  - investigate-condition-id-backfill.ts
  - deep-dive-condition-id-backfill.ts
  - final-backfill-feasibility-test.ts
  - quick-coverage-test.ts
  - investigate-token-id-format.ts

================================================================================
BOTTOM LINE
================================================================================

Metadata-only approach: NOT VIABLE for 77.4M rows

To proceed, choose:
1. Fast + Partial (Option 2 or 3): 2-9 hours
2. Slow + Complete (Option 1): 18-27 days

Current metadata can only recover 0.13% - insufficient for production use.

================================================================================
